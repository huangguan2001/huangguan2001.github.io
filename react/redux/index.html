<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>React - Redux | 村长的菜鸟驿站</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="shortcut icon" href="/img/logo.png">
    <link rel="stylesheet" href="//at.alicdn.com/t/font_3114978_qe0b39no76.css">
    <noscript><meta http-equiv="refresh" content="0; url=https://www.youngkbt.cn/noscript/"><style>.theme-vdoing-content { display:none }</noscript>
    <script src="https://cdn.jsdelivr.net/npm/twikoo@1.4.18/dist/twikoo.all.min.js"></script>
    <script>var _hmt = _hmt || [];
          (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?267c5680c2ffb468ca29c45ffe6801da"; 
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
          })();
          </script>
    <meta name="description" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.23d6b79c.css" as="style"><link rel="preload" href="/assets/js/app.8431c338.js" as="script"><link rel="preload" href="/assets/js/2.57f33dba.js" as="script"><link rel="preload" href="/assets/js/37.3d74bdb1.js" as="script"><link rel="preload" href="/assets/js/4.df550fc8.js" as="script"><link rel="preload" href="/assets/js/6.96e4ab80.js" as="script"><link rel="preload" href="/assets/js/16.b366e5f3.js" as="script"><link rel="preload" href="/assets/js/12.f46b409e.js" as="script"><link rel="prefetch" href="/assets/js/10.241fd0f2.js"><link rel="prefetch" href="/assets/js/100.b284143b.js"><link rel="prefetch" href="/assets/js/101.db55f035.js"><link rel="prefetch" href="/assets/js/102.5854b4f3.js"><link rel="prefetch" href="/assets/js/103.1cdf614a.js"><link rel="prefetch" href="/assets/js/104.26c5bb4f.js"><link rel="prefetch" href="/assets/js/105.11c958c6.js"><link rel="prefetch" href="/assets/js/106.155bf13e.js"><link rel="prefetch" href="/assets/js/107.f6ac19d9.js"><link rel="prefetch" href="/assets/js/108.289135fd.js"><link rel="prefetch" href="/assets/js/109.84bd2fc6.js"><link rel="prefetch" href="/assets/js/11.73762beb.js"><link rel="prefetch" href="/assets/js/110.1bcb9006.js"><link rel="prefetch" href="/assets/js/111.88a7bed6.js"><link rel="prefetch" href="/assets/js/112.487bd3d4.js"><link rel="prefetch" href="/assets/js/113.96fe1da2.js"><link rel="prefetch" href="/assets/js/114.0bfbcdd7.js"><link rel="prefetch" href="/assets/js/115.b1a0d42a.js"><link rel="prefetch" href="/assets/js/116.903f0c31.js"><link rel="prefetch" href="/assets/js/117.22e8cfc3.js"><link rel="prefetch" href="/assets/js/118.501c5629.js"><link rel="prefetch" href="/assets/js/119.ba4f33c0.js"><link rel="prefetch" href="/assets/js/120.647b3d27.js"><link rel="prefetch" href="/assets/js/13.751fa0b5.js"><link rel="prefetch" href="/assets/js/14.a5aa4ccb.js"><link rel="prefetch" href="/assets/js/15.7d22389a.js"><link rel="prefetch" href="/assets/js/17.6d663848.js"><link rel="prefetch" href="/assets/js/18.e909e86e.js"><link rel="prefetch" href="/assets/js/19.3e69b336.js"><link rel="prefetch" href="/assets/js/20.9f2acc5b.js"><link rel="prefetch" href="/assets/js/21.7f939899.js"><link rel="prefetch" href="/assets/js/22.dd9e0a78.js"><link rel="prefetch" href="/assets/js/23.857637a1.js"><link rel="prefetch" href="/assets/js/24.4d30b430.js"><link rel="prefetch" href="/assets/js/25.391f5830.js"><link rel="prefetch" href="/assets/js/26.250b9088.js"><link rel="prefetch" href="/assets/js/27.e1b3d3f7.js"><link rel="prefetch" href="/assets/js/28.839b367e.js"><link rel="prefetch" href="/assets/js/29.f79ec9d9.js"><link rel="prefetch" href="/assets/js/3.0158b1d6.js"><link rel="prefetch" href="/assets/js/30.84e171a9.js"><link rel="prefetch" href="/assets/js/31.77fa252a.js"><link rel="prefetch" href="/assets/js/32.02ac8f5c.js"><link rel="prefetch" href="/assets/js/33.669f6d35.js"><link rel="prefetch" href="/assets/js/34.1c39f535.js"><link rel="prefetch" href="/assets/js/35.10fc2227.js"><link rel="prefetch" href="/assets/js/36.d229a001.js"><link rel="prefetch" href="/assets/js/38.bb556a49.js"><link rel="prefetch" href="/assets/js/39.e4a78b85.js"><link rel="prefetch" href="/assets/js/40.4dafef59.js"><link rel="prefetch" href="/assets/js/41.5d5e7709.js"><link rel="prefetch" href="/assets/js/42.d19d7ec1.js"><link rel="prefetch" href="/assets/js/43.2aa6b8bd.js"><link rel="prefetch" href="/assets/js/44.25e8921b.js"><link rel="prefetch" href="/assets/js/45.7952794d.js"><link rel="prefetch" href="/assets/js/46.edb53a51.js"><link rel="prefetch" href="/assets/js/47.10f5eed3.js"><link rel="prefetch" href="/assets/js/48.8be46123.js"><link rel="prefetch" href="/assets/js/49.f35876f7.js"><link rel="prefetch" href="/assets/js/5.e9ae85a8.js"><link rel="prefetch" href="/assets/js/50.aef57929.js"><link rel="prefetch" href="/assets/js/51.64847ea1.js"><link rel="prefetch" href="/assets/js/52.39b49719.js"><link rel="prefetch" href="/assets/js/53.46514fe6.js"><link rel="prefetch" href="/assets/js/54.c9cd88c7.js"><link rel="prefetch" href="/assets/js/55.8d60c4d8.js"><link rel="prefetch" href="/assets/js/56.8b8bbdeb.js"><link rel="prefetch" href="/assets/js/57.526430bf.js"><link rel="prefetch" href="/assets/js/58.9bee51cc.js"><link rel="prefetch" href="/assets/js/59.30affc34.js"><link rel="prefetch" href="/assets/js/60.a8f2e120.js"><link rel="prefetch" href="/assets/js/61.dfaf883a.js"><link rel="prefetch" href="/assets/js/62.f1681da7.js"><link rel="prefetch" href="/assets/js/63.56b475b1.js"><link rel="prefetch" href="/assets/js/64.7b9f13f8.js"><link rel="prefetch" href="/assets/js/65.483c9566.js"><link rel="prefetch" href="/assets/js/66.91f9af8e.js"><link rel="prefetch" href="/assets/js/67.81b951e6.js"><link rel="prefetch" href="/assets/js/68.7eb92b66.js"><link rel="prefetch" href="/assets/js/69.8dba2253.js"><link rel="prefetch" href="/assets/js/7.b50201c4.js"><link rel="prefetch" href="/assets/js/70.29c74192.js"><link rel="prefetch" href="/assets/js/71.d1916ffa.js"><link rel="prefetch" href="/assets/js/72.7156d0d9.js"><link rel="prefetch" href="/assets/js/73.fc3c5ee7.js"><link rel="prefetch" href="/assets/js/74.9be3a850.js"><link rel="prefetch" href="/assets/js/75.69912c68.js"><link rel="prefetch" href="/assets/js/76.a6daa5c4.js"><link rel="prefetch" href="/assets/js/77.ef1203b6.js"><link rel="prefetch" href="/assets/js/78.2bdb3825.js"><link rel="prefetch" href="/assets/js/79.77d4561d.js"><link rel="prefetch" href="/assets/js/8.e8c12ed2.js"><link rel="prefetch" href="/assets/js/80.abd4c3b8.js"><link rel="prefetch" href="/assets/js/81.9398073a.js"><link rel="prefetch" href="/assets/js/82.0abe2ba7.js"><link rel="prefetch" href="/assets/js/83.a56199a0.js"><link rel="prefetch" href="/assets/js/84.3aa802f2.js"><link rel="prefetch" href="/assets/js/85.03e84298.js"><link rel="prefetch" href="/assets/js/86.bf8c8379.js"><link rel="prefetch" href="/assets/js/87.eebb46d3.js"><link rel="prefetch" href="/assets/js/88.3e0c9f2f.js"><link rel="prefetch" href="/assets/js/89.bce3a5a7.js"><link rel="prefetch" href="/assets/js/9.a96707eb.js"><link rel="prefetch" href="/assets/js/90.837dd328.js"><link rel="prefetch" href="/assets/js/91.c28c5787.js"><link rel="prefetch" href="/assets/js/92.d800ceb2.js"><link rel="prefetch" href="/assets/js/93.b25e4932.js"><link rel="prefetch" href="/assets/js/94.0986d414.js"><link rel="prefetch" href="/assets/js/95.c72a4e7f.js"><link rel="prefetch" href="/assets/js/96.e4e30e8d.js"><link rel="prefetch" href="/assets/js/97.f2b5c4db.js"><link rel="prefetch" href="/assets/js/98.96b93faf.js"><link rel="prefetch" href="/assets/js/99.d3035fc2.js">
    <link rel="stylesheet" href="/assets/css/0.styles.23d6b79c.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="村长的菜鸟驿站" class="logo"> <span class="site-name can-hide">村长的菜鸟驿站</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/navigation/" class="nav-link">导航站</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/front/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>基础</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/html/" class="nav-link">HTML</a></li><li class="dropdown-subitem"><a href="/css/" class="nav-link">CSS</a></li><li class="dropdown-subitem"><a href="/javascript/" class="nav-link">JavaScript</a></li></ul></li><li class="dropdown-item"><h4>框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/react/" class="nav-link router-link-active">React</a></li><li class="dropdown-subitem"><a href="/vue2/" class="nav-link">Vue2</a></li><li class="dropdown-subitem"><a href="/vue3/" class="nav-link">Vue3</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><a href="/tool/" class="link-title">工具</a> <span class="title" style="display:none;">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>管理</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/maven/" class="nav-link">Maven</a></li><li class="dropdown-subitem"><a href="/git/" class="nav-link">Git</a></li></ul></li><li class="dropdown-item"><h4>部署</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/linux/" class="nav-link">Linux</a></li><li class="dropdown-subitem"><a href="/docker/" class="nav-link">Docker</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><!----> <span class="title" style="display:;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/whells-use/" class="nav-link">轮子工具</a></li><li class="dropdown-item"><!----> <a href="/projects/" class="nav-link">项目工程</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>本站</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-subitem"><a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-subitem"><a href="/archives/" class="nav-link">归档</a></li></ul></li><li class="dropdown-item"><h4>我的</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whell/web/" class="nav-link">收藏</a></li><li class="dropdown-subitem"><a href="/about/website/introduce/" class="nav-link">关于</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/message-area/" class="nav-link">留言区</a></div> <a href="https://github.com/huangguan2001" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://qiniu.image.cq-wnl.com/content/202203306f5a2eb785aa45b2be021bb262e84397_647.jpg"> <div class="blogger-info"><h3>村长的菜鸟驿站</h3> <span>永远年轻，永远热泪盈眶</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/navigation/" class="nav-link">导航站</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/front/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>基础</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/html/" class="nav-link">HTML</a></li><li class="dropdown-subitem"><a href="/css/" class="nav-link">CSS</a></li><li class="dropdown-subitem"><a href="/javascript/" class="nav-link">JavaScript</a></li></ul></li><li class="dropdown-item"><h4>框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/react/" class="nav-link router-link-active">React</a></li><li class="dropdown-subitem"><a href="/vue2/" class="nav-link">Vue2</a></li><li class="dropdown-subitem"><a href="/vue3/" class="nav-link">Vue3</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><a href="/tool/" class="link-title">工具</a> <span class="title" style="display:none;">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>管理</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/maven/" class="nav-link">Maven</a></li><li class="dropdown-subitem"><a href="/git/" class="nav-link">Git</a></li></ul></li><li class="dropdown-item"><h4>部署</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/linux/" class="nav-link">Linux</a></li><li class="dropdown-subitem"><a href="/docker/" class="nav-link">Docker</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><!----> <span class="title" style="display:;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/whells-use/" class="nav-link">轮子工具</a></li><li class="dropdown-item"><!----> <a href="/projects/" class="nav-link">项目工程</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>本站</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-subitem"><a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-subitem"><a href="/archives/" class="nav-link">归档</a></li></ul></li><li class="dropdown-item"><h4>我的</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whell/web/" class="nav-link">收藏</a></li><li class="dropdown-subitem"><a href="/about/website/introduce/" class="nav-link">关于</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/message-area/" class="nav-link">留言区</a></div> <a href="https://github.com/huangguan2001" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HTML</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>React</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/react/basics/" class="sidebar-link">React - 基础与核心</a></li><li><a href="/react/scaffolding/" class="sidebar-link">React - 脚手架及使用</a></li><li><a href="/react/routes/" class="sidebar-link">React - 路由</a></li><li><a href="/react/redux/" aria-current="page" class="active sidebar-link">React - Redux</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/react/redux/#redux理解" class="sidebar-link">Redux理解</a></li><li class="sidebar-sub-header level2"><a href="/react/redux/#什么情况下需要使用redux" class="sidebar-link">什么情况下需要使用Redux</a></li><li class="sidebar-sub-header level2"><a href="/react/redux/#redux的三个核心概念" class="sidebar-link">Redux的三个核心概念</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/react/redux/#action" class="sidebar-link">action</a></li><li class="sidebar-sub-header level3"><a href="/react/redux/#reducer" class="sidebar-link">reducer</a></li><li class="sidebar-sub-header level3"><a href="/react/redux/#store" class="sidebar-link">store</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/react/redux/#组件与reducer交互" class="sidebar-link">组件与reducer交互</a></li><li class="sidebar-sub-header level2"><a href="/react/redux/#组件与同步action、reducer交互" class="sidebar-link">组件与同步action、reducer交互</a></li><li class="sidebar-sub-header level2"><a href="/react/redux/#异步action" class="sidebar-link">异步action</a></li><li class="sidebar-sub-header level2"><a href="/react/redux/#redux和react-redux区别" class="sidebar-link">Redux和React-Redux区别</a></li><li class="sidebar-sub-header level2"><a href="/react/redux/#react-redux基本使用" class="sidebar-link">React-Redux基本使用</a></li><li class="sidebar-sub-header level2"><a href="/react/redux/#react-redux优化" class="sidebar-link">React-Redux优化</a></li><li class="sidebar-sub-header level2"><a href="/react/redux/#react-redux数据共享" class="sidebar-link">React-Redux数据共享</a></li><li class="sidebar-sub-header level2"><a href="/react/redux/#react-redux开发者工具的使用" class="sidebar-link">React-Redux开发者工具的使用</a></li><li class="sidebar-sub-header level2"><a href="/react/redux/#react-redux最终优化" class="sidebar-link">React-Redux最终优化</a></li></ul></li><li><a href="/react/function/" class="sidebar-link">React - 函数类型</a></li><li><a href="/react/advanced-knowledge/" class="sidebar-link">React - 进阶知识</a></li><li><a href="/react/parent-circular/" class="sidebar-link">React - 父子传值与循环key</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue2</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue3</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-1baff76c><div class="articleInfo" data-v-1baff76c><ul class="breadcrumbs" data-v-1baff76c><li data-v-1baff76c><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-1baff76c></a></li> <li data-v-1baff76c><a href="/categories/?category=%E5%89%8D%E7%AB%AF" title="分类" data-v-1baff76c>前端</a></li><li data-v-1baff76c><a href="/categories/?category=React" title="分类" data-v-1baff76c>React</a></li></ul> <div class="info" data-v-1baff76c><div title="作者" class="author iconfont icon-touxiang" data-v-1baff76c><a href="https://www.haungguanhao.com" target="_blank" title="作者" class="beLink" data-v-1baff76c>村长</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-1baff76c><a href="javascript:;" data-v-1baff76c>2022-02-21</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">React - Redux<!----></h1> <!----> <div class="theme-vdoing-content content__default"><p></p><div class="table-of-contents"><ul><li><a href="#redux理解">Redux理解</a></li><li><a href="#什么情况下需要使用redux">什么情况下需要使用Redux</a></li><li><a href="#redux的三个核心概念">Redux的三个核心概念</a><ul><li><a href="#action">action</a></li><li><a href="#reducer">reducer</a></li><li><a href="#store">store</a></li></ul></li><li><a href="#组件与reducer交互">组件与reducer交互</a></li><li><a href="#组件与同步action、reducer交互">组件与同步action、reducer交互</a></li><li><a href="#异步action">异步action</a></li><li><a href="#redux和react-redux区别">Redux和React-Redux区别</a></li><li><a href="#react-redux基本使用">React-Redux基本使用</a></li><li><a href="#react-redux优化">React-Redux优化</a></li><li><a href="#react-redux数据共享">React-Redux数据共享</a></li><li><a href="#react-redux开发者工具的使用">React-Redux开发者工具的使用</a></li><li><a href="#react-redux最终优化">React-Redux最终优化</a></li></ul></div><p></p> <h2 id="redux理解"><a href="#redux理解" class="header-anchor">#</a> Redux理解</h2> <ol><li><p>Redux 是一个专门用于做 <strong>状态管理的</strong> JS 库（不是 React 插件库）</p></li> <li><p>它可以用在 React、Angular、Vue 等项目中，但基本与 React 配合使用</p></li> <li><p>作用：集中式管理 React 应用中多个组件 <strong>共享</strong> 的状态</p></li></ol> <h2 id="什么情况下需要使用redux"><a href="#什么情况下需要使用redux" class="header-anchor">#</a> 什么情况下需要使用Redux</h2> <ol><li><p>某个组件的状态，需要让其他组件可以随时拿到（共享）</p></li> <li><p>一个组件需要改变另一个组件的状态（通信）</p></li> <li><p>总体原则：能不用就不用，如果不用比较吃力才考虑使用</p></li></ol> <h2 id="redux的三个核心概念"><a href="#redux的三个核心概念" class="header-anchor">#</a> Redux的三个核心概念</h2> <h3 id="action"><a href="#action" class="header-anchor">#</a> action</h3> <ol><li><p>动作的对象</p></li> <li><p>包含两个属性</p> <ul><li><p>type：标识属性，值为字符串，唯一，必要属性</p></li> <li><p>data：数据属性，值任意类型，可选属性</p></li></ul></li> <li><p>例子：<code>{type:'ADD',data:{name:'kele',age:18}}</code></p></li></ol> <h3 id="reducer"><a href="#reducer" class="header-anchor">#</a> reducer</h3> <ul><li><p>用于初始化状态、加工状态</p></li> <li><p>加工时，根据旧的 state 和 action， 产生新的 state 的 <strong>纯函数</strong></p></li></ul> <h3 id="store"><a href="#store" class="header-anchor">#</a> store</h3> <ol><li><p>将 state、action、reducer 联系在一起的对象</p></li> <li><p>如何得到此对象？</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 引入 createStore，专门用于创建 Redux 中最为核心的 store 对象</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>createStore<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'Redux'</span>
<span class="token comment">// 引入为 Count 组件服务的 reducer</span>
<span class="token keyword">import</span> reducer <span class="token keyword">from</span> <span class="token string">'./reducers'</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>reducer<span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> store
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p>此对象的功能</p> <ul><li><p>getState(): 得到 state</p></li> <li><p>dispatch(action): 分发 action, 触发 reducer 调用, 产生新的 state</p></li> <li><p>subscribe(listener): 注册监听, 当产生了新的 state 时, 自动调用</p></li></ul></li></ol> <h2 id="组件与reducer交互"><a href="#组件与reducer交互" class="header-anchor">#</a> 组件与reducer交互</h2> <ol><li><p>去除 Count 组件自身的状态</p></li> <li><p>src 下建立：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>-Redux
-store.js
-count_reducer.js	//xxx_reducer代表xxx组件的reducer
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>store.js：</p> <ul><li>引入 Redux 中的 createStore 函数，创建一个 store</li> <li>createStore 调用时要传入一个为其服务的 reducer</li> <li>记得暴露 store 对象</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>createStore<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'Redux'</span>
<span class="token comment">// 引入为 Count 组件服务的 reducer</span>
<span class="token keyword">import</span> reducer <span class="token keyword">from</span> <span class="token string">'./reducers'</span>
<span class="token comment">// 暴露 store</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">createStore</span><span class="token punctuation">(</span>reducer<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p>组件的使用</p> <ul><li><p>引入 store，用于获取 Redux 中保存状态</p></li> <li><p>使用 store 的 API：dispatch 方法，直接传入 reducer 中加工</p> <p>参数一：type，reducer 中关联的函数名（需要触发的函数）</p> <p>参数二：data，操作的数据</p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function-variable function">increment</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span>type<span class="token operator">:</span><span class="token string">'increment'</span><span class="token punctuation">,</span><span class="token literal-property property">data</span><span class="token operator">:</span>value<span class="token operator">*</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>reducer.js：</p> <ul><li><p>reducer 的本质是一个函数，接收参数：preState、action，返回加工后的状态</p></li> <li><p>reducer 有两个作用：初始化状态，加工状态</p></li> <li><p>reducer 被第一次调用时，是 store 自动触发的</p> <ul><li><p>传递的 preState 是 undefined</p></li> <li><p>传递的 action 是：<code>{type:'@@REDUX/INIT_a.2.b.4}</code></p></li> <li><p>后面通过 dispatch 传入的 preState 为 Redux 的 state 的数据，action 是要执行数据的行为</p></li></ul></li> <li><p>技巧：开头定义一个常量，给 preState 指定该默认值，当 preState 为 undefined，返回该常量</p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/* 
   1. 该文件是用于创建一个为 Count 组件服务的 reducer，reducer 的本质就是一个函数
   2. reducer 函数会接到两个参数，分别为：之前的状态（preState），动作对象（action）
*/</span>
<span class="token keyword">const</span> initState <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment">// 初始化状态</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">countReducer</span><span class="token punctuation">(</span><span class="token parameter">preState<span class="token operator">=</span>initState<span class="token punctuation">,</span>action</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token comment">// 从 action 对象中获取：type、data</span>
   <span class="token keyword">const</span> <span class="token punctuation">{</span>type<span class="token punctuation">,</span>data<span class="token punctuation">}</span> <span class="token operator">=</span> action
   <span class="token comment">// 根据 type 决定如何加工数据</span>
   <span class="token keyword">switch</span> <span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   	<span class="token keyword">case</span> <span class="token string">'increment'</span><span class="token operator">:</span> <span class="token comment">// 如果是加</span>
   		<span class="token keyword">return</span> preState <span class="token operator">+</span> data
   	<span class="token keyword">case</span> <span class="token string">'decrement'</span><span class="token operator">:</span> <span class="token comment">// 若果是减</span>
   		<span class="token keyword">return</span> preState <span class="token operator">-</span> data
   	<span class="token keyword">default</span><span class="token operator">:</span>
   		<span class="token keyword">return</span> preState
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></li> <li><p>在 index.js 中监测 store 中状态的改变，一旦发生改变重新渲染 <code>&lt;App/&gt;</code></p> <p>备注：Redux 只负责管理状态，至于状态的改变（<code>this.setState={}</code>）驱动着页面的展示，要靠我们自己写。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App<span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// 监测 Redux 中状态的改变，如 Redux 的状态发生了改变，那么重新渲染 App 组件</span>
store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
	ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App<span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li></ol> <h2 id="组件与同步action、reducer交互"><a href="#组件与同步action、reducer交互" class="header-anchor">#</a> 组件与同步action、reducer交互</h2> <ol><li><p>action.js：专门用于创建 action 对象，对 dispatch 传入的值进行封装，固定 type，只需传入 data</p></li> <li><p>细节：如果使用箭头函数简写模式，return 的时对象，需要使用括号 <code>()</code>，否则默认 <code>{}</code> 是函数形式而不是对象形式</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/* 
	该文件专门为 Count 组件生成 action 对象
*/</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">createIncrementAction</span> <span class="token operator">=</span> <span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">'increment'</span><span class="token punctuation">,</span>data<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">createDecrementAction</span> <span class="token operator">=</span> <span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">'decrement'</span><span class="token punctuation">,</span>data<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p>原先组件的 dispatch 变为</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>createIncrementAction<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./action'</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createIncrementAction</span><span class="token punctuation">(</span>value<span class="token operator">*</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>constant.js：当出现多个常量时，此文件放置 type 值在 Redux 文件夹里</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/* 
	该模块是用于定义 action 对象中 type 类型的常量值，目的只有一个：便于管理的同时防止程序员单词写错
*/</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">INCREMENT</span> <span class="token operator">=</span> <span class="token string">'increment'</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">DECREMENT</span> <span class="token operator">=</span> <span class="token string">'decrement'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p>此时其他文件的对用常量变为</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// reducer 文件</span>
<span class="token operator">...</span><span class="token operator">...</span>
<span class="token keyword">switch</span> <span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token constant">INCREMENT</span><span class="token operator">:</span> <span class="token comment">// 如果是加</span>
        <span class="token keyword">return</span> preState <span class="token operator">+</span> data
    <span class="token keyword">case</span> <span class="token constant">DECREMENT</span><span class="token operator">:</span> <span class="token comment">// 若果是减</span>
        <span class="token keyword">return</span> preState <span class="token operator">-</span> data
    <span class="token keyword">default</span><span class="token operator">:</span>
        <span class="token keyword">return</span> preState
<span class="token punctuation">}</span>
<span class="token operator">...</span><span class="token punctuation">.</span>
<span class="token comment">// action 文件：</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">createIncrementAction</span> <span class="token operator">=</span> <span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span><span class="token constant">INCREMENT</span><span class="token punctuation">,</span>data<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">createDecrementAction</span> <span class="token operator">=</span> <span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span><span class="token constant">DECREMENT</span><span class="token punctuation">,</span>data<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">...</span><span class="token operator">...</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div></li></ol> <h2 id="异步action"><a href="#异步action" class="header-anchor">#</a> 异步action</h2> <p>同步 action 和异步 action 区别：前者返回值是一个对象，后者返回值是一个函数，因为只有函数才能开启异步，如定时器</p> <blockquote><p>使用方式：（引入中间库）</p></blockquote> <ul><li><p>明确：延迟的动作不想交给组件自身，想交给 action</p></li> <li><p>何时需要异步 action：想要对状态进行操作，但是具体的数据靠异步任务返回</p></li> <li><p>具体编码：</p> <ol><li><p><code>yarn add Redux-thunk</code>，并配置在 store 中</p></li> <li><p>创建 action 的函数不再返回一般对象，而是一个函数，该函数中写异步任务</p></li> <li><p>异步任务有结果后，分发一个同步的 action 去真正操作数据</p></li></ol></li> <li><p>备注：异步 action 不是必须要写的，完全可以自己等待异步任务的结果了再去分发同步 action</p></li> <li><p>异步 action 一定会 dispatch 同步 action</p></li></ul> <blockquote><p>代码</p></blockquote> <p>store.js：引入中间件，并且在 createStore 时使用</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 引入 createStore，专门用于创建 Redux 中最为核心的 store 对象</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>createStore<span class="token punctuation">,</span>applyMiddleware<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'Redux'</span>
<span class="token comment">// 引入为 Count 组件服务的 reducer</span>
<span class="token keyword">import</span> countReducer <span class="token keyword">from</span> <span class="token string">'./count_reducer'</span>
<span class="token comment">// 引入 Redux-thunk，用于支持异步 action</span>
<span class="token keyword">import</span> thunk <span class="token keyword">from</span> <span class="token string">'Redux-thunk'</span>
<span class="token comment">// 暴露 store</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">createStore</span><span class="token punctuation">(</span>countReducer<span class="token punctuation">,</span><span class="token function">applyMiddleware</span><span class="token punctuation">(</span>thunk<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>action.js：使用异步 action</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span><span class="token constant">INCREMENT</span><span class="token punctuation">,</span><span class="token constant">DECREMENT</span><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./constant'</span> <span class="token comment">// 常量文件名</span>

<span class="token comment">// 同步a ction，就是指 action 的值为 Object 类型的一般对象</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">createIncrementAction</span> <span class="token operator">=</span> <span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span><span class="token constant">INCREMENT</span><span class="token punctuation">,</span>data<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">createDecrementAction</span> <span class="token operator">=</span> <span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span><span class="token constant">DECREMENT</span><span class="token punctuation">,</span>data<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 异步 action，就是指 action 的值为函数,异步 action 中一般都会调用同步 action，异步 action 不是必须要用的。</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">createIncrementAsyncAction</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span>time</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter">dispatch</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
		<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
			<span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createIncrementAction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>time<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>记住：如果不安装并且使用中间件，action.js 里的异步 action 代码会 <strong>报错</strong>。</p> <h2 id="redux和react-redux区别"><a href="#redux和react-redux区别" class="header-anchor">#</a> Redux和React-Redux区别</h2> <ol><li>Redux 是 React 官方团队出品，React-Redux 是 Facebook 官方团队出品</li> <li>React-Redux 对 Redux 进行再次封装，解耦更明显，分离都明显，功能更齐全</li> <li>使用了 React-Redux，则不需要自己主动监测状态变化，页面渲染</li> <li>使用了 React-Redux，UI组件不能写任何 Redux 的内容，必须使用其父容器组件传来的值（父组件才写 Redux 的内容，并且响应事件，通过 props 传给其子 UI 组件）</li></ol> <h2 id="react-redux基本使用"><a href="#react-redux基本使用" class="header-anchor">#</a> React-Redux基本使用</h2> <ol><li><p>两个概念：（React-Redux 对使用 Redux 的组件进行再次封装）</p> <ul><li><p>UI 组件：不能使用任何 Redux 的 api，只负责页面的呈现、交互等。放在 components 文件夹</p></li> <li><p>容器组件：负责和 Redux 通信，将结果交给 UI 组件。放在 contains 文件夹</p></li></ul></li> <li><p>如何创建一个容器组件？靠 React-Redux 的 connect 函数</p> <p>格式：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 使用 connect()() 创建并暴露一个 Count 的容器组件</span>
<span class="token function">connect</span><span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">,</span>mapDispatchToProps<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token constant">UI</span>组件<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>左边括号：两个参数，且参数都必须为函数，右边括号：UI 组件的名称，需 import 引入。</p> <p>mapStateToProps：映射状态，返回值是一个对象，是一个传递状态（数据）的函数，给 UI 组件。</p> <p>mapDispatchToProps：映射操作状态的方法，返回值是一个对象，是一个传递操作状态的方法的函数，或者对象，给 reducer 加工。</p> <p>流程：UI 组件触发事件，事件通过 mapDispatchToProps 传入 reducer 进行加工，然后更新状态，mapStateToProps 通过 props 传更新的状态给 UI 组件，UI 组件直接获取。</p> <p>备注：容器组件中的 store 是靠 props 传进去的，而不是在容器组件中直接引入（App 是 Count 的父组件，Count 组件有容器组件和 UI 组件），然后 App 组件传 store 给 Count 容器组件，Count 容器组件进行操作后数据传给 CountUI 组件</p></li></ol> <blockquote><p>创建容器组件</p></blockquote> <p>App 组件</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">...</span><span class="token operator">...</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
	<span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">(</span>
			<span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
				<span class="token punctuation">{</span><span class="token comment">/* 给容器组件传递store */</span><span class="token punctuation">}</span>
				<span class="token operator">&lt;</span>Count store<span class="token operator">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
		<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">...</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>Count 容器组件（获取父组件传入的 store，并且使用 dispatch 对 Redux 进行数据加工，后返回给 CountUI 组件）</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 引入 Count 的 UI 组件</span>
<span class="token keyword">import</span> CountUI <span class="token keyword">from</span> <span class="token string">'../../components/Count'</span>
<span class="token comment">// 引入 action</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
	createIncrementAction<span class="token punctuation">,</span>
	createDecrementAction<span class="token punctuation">,</span>
	createIncrementAsyncAction
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../Redux/count_action'</span>
<span class="token comment">// 引入 connect 用于连接UI组件与 Redux</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>connect<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'React-Redux'</span>
<span class="token comment">/* 
	1. mapStateToProps 函数返回的是一个对象；
	2. 返回的对象中的 key 就作为传递给 UI 组件 props 的 key，value 就作为传递给 UI 组件 props 的 value
	3. mapStateToProps 用于传递状态
*/</span>
<span class="token keyword">function</span> <span class="token function">mapStateToProps</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token literal-property property">count</span><span class="token operator">:</span>state<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 
	1.mapDispatchToProps 函数返回的是一个对象；
	2.返回的对象中的 key 就作为传递给 UI 组件 props 的 key，value 就作为传递给 UI 组件 props 的 value
	3.mapDispatchToProps 用于传递操作状态的方法
*/</span>
<span class="token keyword">function</span> <span class="token function">mapDispatchToProps</span><span class="token punctuation">(</span><span class="token parameter">dispatch</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token punctuation">{</span>
		<span class="token function-variable function">increment</span><span class="token operator">:</span><span class="token parameter">number</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createIncrementAction</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token function-variable function">decrement</span><span class="token operator">:</span><span class="token parameter">number</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createDecrementAction</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token function-variable function">incrementAsync</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">number<span class="token punctuation">,</span>time</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createIncrementAsyncAction</span><span class="token punctuation">(</span>number<span class="token punctuation">,</span>time<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 使用 connect()() 创建并暴露一个 Count 的容器组件</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">,</span>mapDispatchToProps<span class="token punctuation">)</span><span class="token punctuation">(</span>CountUI<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p>CountUI 组件（直接使用 props 发送给父组件自己的事件和参数，然后父组件们执行完操作，重新渲染画面）</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Count</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
    <span class="token comment">//加法</span>
    <span class="token function-variable function">increment</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span>value<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>selectNumber
        <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span>value<span class="token operator">*</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token operator">...</span> <span class="token comment">//减法、异步加法</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">(</span>
			<span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>当前求和为：<span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>count<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>select ref<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">c</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>selectNumber <span class="token operator">=</span> c<span class="token punctuation">}</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>option value<span class="token operator">=</span><span class="token string">&quot;1&quot;</span><span class="token operator">&gt;</span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>option<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>option value<span class="token operator">=</span><span class="token string">&quot;2&quot;</span><span class="token operator">&gt;</span><span class="token number">2</span><span class="token operator">&lt;</span><span class="token operator">/</span>option<span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>option value<span class="token operator">=</span><span class="token string">&quot;3&quot;</span><span class="token operator">&gt;</span><span class="token number">3</span><span class="token operator">&lt;</span><span class="token operator">/</span>option<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>select<span class="token operator">&gt;</span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span>
				<span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>increment<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">+</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span>
     			<span class="token operator">...</span><span class="token operator">...</span><span class="token punctuation">{</span><span class="token comment">/* 减法、异步加法的按钮和事件 */</span><span class="token punctuation">}</span>           
			<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
		<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>优化：mapDispatchToProps，也可以是一个对象，看下方代码块的简写：</p> <p>分析：<code>this.props.increment(value * 1)</code> 调用对象的 key：increment，随后使用 createIncrementAction 函数，并且因为调用的时候传入参数 <code>value * 1</code>，所以把该参数传入 createIncrementAction 函数，该函数随后返回 action 对象，dispatch 方法是 API 自动加入，已经优化</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span>
	<span class="token parameter">state</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">count</span><span class="token operator">:</span>state<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

	<span class="token comment">// mapDispatchToProps 的一般写法</span>
	<span class="token comment">/* dispatch =&gt; ({
		increment:number =&gt; dispatch(createIncrementAction(number)),
		decrement:number =&gt; dispatch(createDecrementAction(number)),
		incrementAsync:(number,time) =&gt; dispatch(createIncrementAsyncAction(number,time)),
	}) */</span>

	<span class="token comment">// mapDispatchToProps 的简写</span>
	<span class="token punctuation">{</span>
		<span class="token literal-property property">increment</span><span class="token operator">:</span>createIncrementAction<span class="token punctuation">,</span>
		<span class="token literal-property property">decrement</span><span class="token operator">:</span>createDecrementAction<span class="token punctuation">,</span>
		<span class="token literal-property property">incrementAsync</span><span class="token operator">:</span>createIncrementAsyncAction<span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">(</span>Count<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="react-redux优化"><a href="#react-redux优化" class="header-anchor">#</a> React-Redux优化</h2> <p>容器组件和 UI 组件整合一个文件</p> <ul><li><p>因为容器组件需要引入 UI 组件，然后 <code>connect(a,b)(UI组件)</code>，为何不直接放在一起，然后无需引入 UI 组件，直接整合一个文件</p></li> <li><p>整合一个文件后，只需 <code>export default connect(a,b)(UI组件)</code>即可，UI 组件因为都在一个文件，内部直接使用</p></li></ul> <p>无需自己给容器组件传递 store，给 <code>&lt;App/&gt;</code> 包裹一个 <code>&lt;Provider store={store}&gt;</code> 即可。目的是让 App 所有的后代容器组件都能接收到 store。</p> <ul><li><p>原先不优化（在 App 组件）</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>Count store<span class="token operator">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>Count store<span class="token operator">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>Count store<span class="token operator">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>Count store<span class="token operator">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>Count store<span class="token operator">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li> <li><p>优化后（入口文件）</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">...</span><span class="token operator">...</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>Provider<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'React-Redux'</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
    <span class="token comment">/* 此处需要用Provider包裹App，目的是让App所有的后代容器组件都能接收到store */</span>
    <span class="token operator">&lt;</span>Provider store<span class="token operator">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>App<span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>Provider<span class="token operator">&gt;</span><span class="token punctuation">,</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token comment">// 此时App文件为</span>
<span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>Count<span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>Count<span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>Count<span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>Count<span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div></li></ul> <p>使用了 React-Redux 后不用再自己检测 Redux 中状态的改变了，容器组件可以自动完成这个工作。下方代码（入口文件里）可以 <strong>去掉</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 监测 Redux 中状态的改变，如 Redux 的状态发生了改变，那么重新渲染 App 组件</span>
store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
	ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App<span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>mapDispatchToProps 也可以简单的写成一个对象，具体内容看 <a href="#react-redux%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8">React-Redux 基本使用</a>。</p> <p>一个组件要和 Redux「打交道」要经过哪几步？（融合 1、3、4 的内容）</p> <ul><li><p>定义好 UI 组件，不暴露</p></li> <li><p>引入 connect 生成一个容器组件，并暴露，写法如下：</p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span>
    <span class="token parameter">state</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">key</span><span class="token operator">:</span>value<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 映射状态</span>
    <span class="token punctuation">{</span><span class="token literal-property property">key</span><span class="token operator">:</span>xxxxxAction<span class="token punctuation">}</span> <span class="token comment">// 映射操作状态的方法，尽量触发简写形式</span>
<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token constant">UI</span>组件<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>在 UI 组件中通过 <code>this.props.xxx</code> 读取和操作状态，即调用上方（<strong>5</strong>）第三行的 key。</p> <h2 id="react-redux数据共享"><a href="#react-redux数据共享" class="header-anchor">#</a> React-Redux数据共享</h2> <ol><li><p>定义一个 Pserson 组件，和 Count 组件通过 Redux 共享数据</p></li> <li><p>为 Person 组件编写：reducer、action，配置 constant 常量</p></li> <li><p>重点：Person 的 reducer 和 Count 的 Reducer 要使用 combineReducers 进行合并，需要引入合并后的总状态是一个对象</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 引入 createStore，专门用于创建Redux中最为核心的store对象</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>createStore<span class="token punctuation">,</span>applyMiddleware<span class="token punctuation">,</span>combineReducers<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'Redux'</span>
<span class="token comment">// 引入为 Count 组件服务的 reducer</span>
<span class="token keyword">import</span> countReducer <span class="token keyword">from</span> <span class="token string">'./reducers/count'</span>
<span class="token comment">// 引入 为 Count 组件服务的 reducer</span>
<span class="token keyword">import</span> personReducer <span class="token keyword">from</span> <span class="token string">'./reducers/person'</span>
<span class="token comment">// 引入 Redux-thunk，用于支持异步 action</span>
<span class="token keyword">import</span> thunk <span class="token keyword">from</span> <span class="token string">'Redux-thunk'</span>

<span class="token comment">// 汇总所有的 reducer 变为一个总的 reducer</span>
<span class="token keyword">const</span> allReducer <span class="token operator">=</span> <span class="token function">combineReducers</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">countReducer</span><span class="token operator">:</span>countReducer<span class="token punctuation">,</span>
    <span class="token literal-property property">countReducer</span><span class="token operator">:</span>personReducer
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 暴露 store</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">createStore</span><span class="token punctuation">(</span>allReducer<span class="token punctuation">,</span><span class="token function">applyMiddleware</span><span class="token punctuation">(</span>thunk<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div></li> <li><p>交给 store 的是总 reducer（对象），最后注意在组件中取出状态（state）的时候，不再直接是 state，而是 <code>state.countReducer</code> 和 <code>state.personReducer</code>。如果交给 store 的是一个 value 值，通过 state 取这个 value 值，对象的话通过 <code>state.xxx</code> 取 key 得 value</p></li></ol> <h2 id="react-redux开发者工具的使用"><a href="#react-redux开发者工具的使用" class="header-anchor">#</a> React-Redux开发者工具的使用</h2> <ol><li><p>使用开发者工具需要安装第三方库支持：（去 chrome 扩展商城下载）</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>yarn add Redux<span class="token operator">-</span>devtools<span class="token operator">-</span>extension
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>store 中进行配置</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>composeWithDevTools<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'Redux-devtools-extension'</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>allReducer<span class="token punctuation">,</span><span class="token function">composeWithDevTools</span><span class="token punctuation">(</span><span class="token function">applyMiddleware</span><span class="token punctuation">(</span>thunk<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// 如果没有引入 Redux-thunk</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>allReducer<span class="token punctuation">,</span><span class="token function">composeWithDevTools</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li></ol> <h2 id="react-redux最终优化"><a href="#react-redux最终优化" class="header-anchor">#</a> React-Redux最终优化</h2> <ul><li><p>所有变量名字要规范，尽量触发对象的简写形式。</p></li> <li><p>reducers 文件夹中，编写 index.js 专门用于汇总并暴露所有的 reducer</p></li> <li><p>状态如果是一个数组，对该数组进行操作，不能使用 unshift，push 等方法，这样无法改变数组本身的地址，从而数据无法被监测到，实现更新。Vue 框架则相反，必须使用 unshift，push 等方法，才能监测到数据的改变。</p></li></ul></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/huangguan2001/edit/master/docs/10.前端/50.React/07.React - Redux.md" target="_blank" rel="noopener noreferrer">编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/tags/?tag=React" title="标签">#React</a></div> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">2022/04/05, 19:18:42</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/react/routes/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">React - 路由</div></a> <a href="/react/function/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">React - 函数类型</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/react/routes/" class="prev">React - 路由</a></span> <span class="next"><a href="/react/function/">React - 函数类型</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/yonyou/client-development/"><div>
            YonYou - Client端开发
            <span class="title-tag">
              原创
            </span></div></a> <span class="date">03-03</span></dt></dl><dl><dd>02</dd> <dt><a href="/yonyou/development-process/"><div>
            YonYou - 开发流程
            <span class="title-tag">
              原创
            </span></div></a> <span class="date">03-02</span></dt></dl><dl><dd>03</dd> <dt><a href="/java/d/"><div>
            技术随笔 - Java启动的-D参数
            <!----></div></a> <span class="date">03-02</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="https://github.com/huangguan2001" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://gitee.com/huangguan2001" title="Gitee" target="_blank" class="iconfont icon-gitee"></a><a href="tencent://message/?uin=64867944&amp;Site=&amp;Menu=yes" title="QQ" target="_blank" class="iconfont icon-QQ"></a><a href="mailto:64867944@qq.com" title="联系我" target="_blank" class="iconfont icon-youjian"></a><a href="https://music.163.com/#/user/home?id=365907246" title="音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2021-2022
    <span>村长 | 菜鸟驿站</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><!----><div></div><div></div><div></div><div id="tcomment"></div><!----><APlayer audio="" fixed="true" mini="true" theme="#b7daff" loop="loop" order="list" preload="auto" volume="0.7" mutex="true" lrc-type="0" list-max-height="250" storage-name="vuepress-plugin-meting" id="aplayer-fixed"></APlayer><div></div></div></div>
    <script src="/assets/js/app.8431c338.js" defer></script><script src="/assets/js/2.57f33dba.js" defer></script><script src="/assets/js/37.3d74bdb1.js" defer></script><script src="/assets/js/4.df550fc8.js" defer></script><script src="/assets/js/6.96e4ab80.js" defer></script><script src="/assets/js/16.b366e5f3.js" defer></script><script src="/assets/js/12.f46b409e.js" defer></script>
  </body>
</html>
